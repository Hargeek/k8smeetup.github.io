
<p>本页展示怎么样使用 Calico 来提供 NetworkPolicy</p>

<ul id="markdown-toc">
  <li><a href="#before-you-begin" id="markdown-toc-before-you-begin">Before you begin</a></li>
  <li><a href="#使用-calico-部署一个集群" id="markdown-toc-使用-calico-部署一个集群">使用 Calico 部署一个集群</a></li>
  <li><a href="#理解-calico-组件" id="markdown-toc-理解-calico-组件">理解 Calico 组件</a></li>
  <li><a href="#whats-next" id="markdown-toc-whats-next">What’s next</a></li>
</ul>

<h2 id="before-you-begin">Before you begin</h2>

<ul>
  <li>为 Kubernetes 安装 Calico</li>
</ul>

<h2 id="使用-calico-部署一个集群">使用 Calico 部署一个集群</h2>

<p>使用如下命令，您可以在默认的 <a href="/docs/getting-started-guides/gce">GCE 部署环境中</a> 部署一个使用 Calico 来提供网络策略的集群：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NETWORK_POLICY_PROVIDER</span><span class="o">=</span>calico
<span class="nb">export </span><span class="nv">KUBE_NODE_OS_DISTRIBUTION</span><span class="o">=</span>debian
curl <span class="nt">-sS</span> https://get.k8s.io | bash
</code></pre></div></div>

<p>如果希望了解其它的部署选项，请您参考 <a href="http://docs.projectcalico.org/">Calico 项目文档</a></p>

<h2 id="理解-calico-组件">理解 Calico 组件</h2>

<p>部署使用 Calico 的集群其实是增加了支持 Kubernetes NetworkPolicy 的 Pods， 这些 Pods 运行在 <code class="highlighter-rouge">kube-system</code> 命名空间下。</p>

<p>使用如下方式去查看这些运行的 Pods：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get pods <span class="nt">--namespace</span><span class="o">=</span>kube-system
</code></pre></div></div>

<p>您可以看到类似下面这样的一个 Pods 列表：</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">NAME                                                 READY     STATUS    RESTARTS   AGE
calico-node-kubernetes-minion-group-jck6             1/1       Running   0          46m
calico-node-kubernetes-minion-group-k9jy             1/1       Running   0          46m
calico-node-kubernetes-minion-group-szgr             1/1       Running   0          46m
calico-policy-controller-65rw1                       1/1       Running   0          46m
</span><span class="c">...
</span></code></pre></div></div>

<p>主要有两种组件</p>

<ul>
  <li>
    <p>在集群的每个节点上都会运行一个以 <code class="highlighter-rouge">calico-node</code> 开头命名的 Pod，用于配置 iptables 去实现那些机器上 Pods 的出/入网络策略</p>
  </li>
  <li>
    <p>整个集群环境只有一个以 <code class="highlighter-rouge">calico-policy-controller</code> 开头命名的 Pod，用于从 Kubernetes API 中读取策略和标签信息，适当的对 Calico 进行配置</p>
  </li>
</ul>

<h2 id="whats-next">What’s next</h2>

<p>集群部署完成之后，您可以通过 <a href="/docs/getting-started-guides/network-policy/walkthrough">NetworkPolicy 入门指南</a>去尝试使用 Kubernetes NetworkPolicy</p>

