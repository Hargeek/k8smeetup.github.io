
  
    
    

  

  
    
    

  

  
    
    

  

  
    

<!Doctype html>
<html id="docs" class="Tasks">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"><!-- default styles.css on -->
    <link rel="stylesheet" type="text/css" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="/css/sweetalert.css">
    <link rel="stylesheet" type="text/css" href="/css/callouts.css">
    <link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">
    
    
    <!-- no custom css detected -->

    
    <meta name="description" content="Debug Services" />
    

    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/custom-jekyll/tags.js"></script>
    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Debug Services | Kubernetes</title>
<meta property="og:title" content="Debug Services" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Production-Grade Container Orchestration" />
<meta property="og:description" content="Production-Grade Container Orchestration" />
<link rel="canonical" href="http://0.0.0.0:4000/docs/tasks/debug-application-cluster/debug-service/" />
<meta property="og:url" content="http://0.0.0.0:4000/docs/tasks/debug-application-cluster/debug-service/" />
<meta property="og:site_name" content="Kubernetes" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kubernetesio" />
<script type="application/ld+json">
{"name":null,"description":"Production-Grade Container Orchestration","author":null,"@type":"WebPage","url":"http://0.0.0.0:4000/docs/tasks/debug-application-cluster/debug-service/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4000/images/favicon.png"}},"image":null,"headline":"Debug Services","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            <li><a href="/docs/home/">Documentation</a></li>
            <li><a href="http://blog.kubernetes.io/">Blog</a></li>
            <li><a href="/partners/">Partners</a></li>
            <li><a href="/community/">Community</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
            <li>
                <a href="#">
                    v1.8 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                  <li><a href="https://kubernetes.io/docs/home/">v1.8</a></li>
                
                  <li><a href="https://v1-7.docs.kubernetes.io/docs/home/">v1.7</a></li>
                
                  <li><a href="https://v1-6.docs.kubernetes.io/docs/home/">v1.6</a></li>
                
                  <li><a href="https://v1-5.docs.kubernetes.io/docs/">v1.5</a></li>
                
                  <li><a href="https://v1-4.docs.kubernetes.io/docs/">v1.4</a></li>
                
                </ul>
              </li>
            </li>
        </ul>
        <!-- <a href="/docs/home" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a> -->
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="http://blog.kubernetes.io">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Tasks</h1>
  <h5>Step-by-step instructions for performing operations with Kubernetes.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/home/" >HOME</a></li>
      <li><a href="/docs/setup/" >SETUP</a></li>
      <li><a href="/docs/concepts/" >CONCEPTS</a></li>
      <li><a href="/docs/tasks/" class="YAH">TASKS</a></li>
      <li><a href="/docs/tutorials/" >TUTORIALS</a></li>
      <li><a href="/docs/reference/" >REFERENCE</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
    </div>
  </div>
</section>




<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
          
  

    

    
      <a class="item" data-title="任务" href="/docs/tasks/"></a>
    
  

  
    <div class="item" data-title="Install Tools">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Install and Set Up kubectl" href="/docs/tasks/tools/install-kubectl/"></a>
    
  

  

    

    
      <a class="item" data-title="Install Minikube" href="/docs/tasks/tools/install-minikube/"></a>
    
  

  

    

    
      <a class="item" data-title="安装 kubeadm" href="/docs/setup/independent/install-kubeadm/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Configure Pods and Containers">
      <div class="container">
        
  

    

    
      <a class="item" data-title="给容器和Pod分配内存资源" href="/docs/tasks/configure-pod-container/assign-memory-resource/"></a>
    
  

  

    

    
      <a class="item" data-title="给容器和Pod分配CPU资源" href="/docs/tasks/configure-pod-container/assign-cpu-resource/"></a>
    
  

  

    

    
      <a class="item" data-title="给 Pod 配置服务质量等级" href="/docs/tasks/configure-pod-container/quality-service-pod/"></a>
    
  

  

    

    
      <a class="item" data-title="Assign CPU and RAM Resources to a Container" href="/docs/tasks/configure-pod-container/assign-cpu-ram-container/"></a>
    
  

  

    

    
      <a class="item" data-title="Assign Opaque Integer Resources to a Container" href="/docs/tasks/configure-pod-container/opaque-integer-resource/"></a>
    
  

  

    

    
      <a class="item" data-title="配置Pod使用卷作为存储" href="/docs/tasks/configure-pod-container/configure-volume-storage/"></a>
    
  

  

    

    
      <a class="item" data-title="" href="/docs/tasks/configure-pod-container/configure-persistent-volume-storage/"></a>
    
  

  

    

    
      <a class="item" data-title="配置Pod使用配套的存储卷作为存储" href="/docs/tasks/configure-pod-container/configure-projected-volume-storage/"></a>
    
  

  

    

    
  

  

    

    
      <a class="item" data-title="Configure a Security Context for a Pod or Container" href="/docs/tasks/configure-pod-container/security-context/"></a>
    
  

  

    

    
  

  

    

    
      <a class="item" data-title="配置Pod的Service Account" href="/docs/tasks/configure-pod-container/configure-service-account/"></a>
    
  

  

    

    
      <a class="item" data-title="从私有仓库拉取镜像" href="/docs/tasks/configure-pod-container/pull-image-private-registry/"></a>
    
  

  

    

    
      <a class="item" data-title="配置Liveness和Readiness探针" href="/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/"></a>
    
  

  

    

    
      <a class="item" data-title="向节点分配 Pod" href="/docs/tasks/configure-pod-container/assign-pods-nodes/"></a>
    
  

  

    

    
      <a class="item" data-title="配置Pod初始化" href="/docs/tasks/configure-pod-container/configure-pod-initialization/"></a>
    
  

  

    

    
      <a class="item" data-title="给容器生命周期设置操作事件" href="/docs/tasks/configure-pod-container/attach-handler-lifecycle-event/"></a>
    
  

  

    

    
      <a class="item" data-title="使用ConfigMap配置容器" href="/docs/tasks/configure-pod-container/configmap/"></a>
    
  

  

    

    
      <a class="item" data-title="在 Pod 里使用 ConfigMap 数据" href="/docs/tasks/configure-pod-container/configure-pod-configmap/"></a>
    
  

  

    

    
      <a class="item" data-title="Translate a Docker Compose File to Kubernetes Resources" href="/docs/tools/kompose/user-guide/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Inject Data Into Applications">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Define a Command and Arguments for a Container" href="/docs/tasks/inject-data-application/define-command-argument-container/"></a>
    
  

  

    

    
      <a class="item" data-title="Define Environment Variables for a Container" href="/docs/tasks/inject-data-application/define-environment-variable-container/"></a>
    
  

  

    

    
      <a class="item" data-title="Expose Pod Information to Containers Through Environment Variables" href="/docs/tasks/inject-data-application/environment-variable-expose-pod-information/"></a>
    
  

  

    

    
      <a class="item" data-title="Expose Pod Information to Containers Through Files" href="/docs/tasks/inject-data-application/downward-api-volume-expose-pod-information/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Secrets 安全地分发凭证" href="/docs/tasks/inject-data-application/distribute-credentials-secure/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 PodPreset 将信息注入 Pods" href="/docs/tasks/inject-data-application/podpreset/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Run Applications">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Run a Stateless Application Using a Deployment" href="/docs/tasks/run-application/run-stateless-application-deployment/"></a>
    
  

  

    

    
      <a class="item" data-title="Run a Single-Instance Stateful Application" href="/docs/tasks/run-application/run-single-instance-stateful-application/"></a>
    
  

  

    

    
      <a class="item" data-title="Run a Replicated Stateful Application" href="/docs/tasks/run-application/run-replicated-stateful-application/"></a>
    
  

  

    

    
      <a class="item" data-title="Update API Objects in Place Using kubectl patch" href="/docs/tasks/run-application/update-api-object-kubectl-patch/"></a>
    
  

  

    

    
      <a class="item" data-title="Upgrade from PetSets to StatefulSets" href="/docs/tasks/run-application/upgrade-pet-set-to-stateful-set/"></a>
    
  

  

    

    
      <a class="item" data-title="Scale a StatefulSet" href="/docs/tasks/run-application/scale-stateful-set/"></a>
    
  

  

    

    
      <a class="item" data-title="删除StatefulSet" href="/docs/tasks/run-application/delete-stateful-set/"></a>
    
  

  

    

    
      <a class="item" data-title="强制删除StatefulSet中的Pod" href="/docs/tasks/run-application/force-delete-stateful-set-pod/"></a>
    
  

  

    

    
      <a class="item" data-title="Perform Rolling Update Using a Replication Controller" href="/docs/tasks/run-application/rolling-update-replication-controller/"></a>
    
  

  

    

    
      <a class="item" data-title="Horizontal Pod Autoscaling" href="/docs/tasks/run-application/horizontal-pod-autoscale/"></a>
    
  

  

    

    
      <a class="item" data-title="Pod水平自动伸缩（Horizontal Pod Autoscaling）演练" href="/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/"></a>
    
  

  

    

    
      <a class="item" data-title="指定应用程序的中断预算（Disruption Budget）" href="/docs/tasks/run-application/configure-pdb/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Run Jobs">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Parallel Processing using Expansions" href="/docs/tasks/job/parallel-processing-expansion/"></a>
    
  

  

    

    
      <a class="item" data-title="Coarse Parallel Processing Using a Work Queue" href="/docs/tasks/job/coarse-parallel-processing-work-queue/"></a>
    
  

  

    

    
      <a class="item" data-title="Fine Parallel Processing Using a Work Queue" href="/docs/tasks/job/fine-parallel-processing-work-queue/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Access Applications in a Cluster">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Web UI (Dashboard)" href="/docs/tasks/access-application-cluster/web-ui-dashboard/"></a>
    
  

  

    

    
      <a class="item" data-title="访问集群" href="/docs/tasks/access-application-cluster/access-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="配置对多集群的访问" href="/docs/tasks/access-application-cluster/configure-access-multiple-clusters/"></a>
    
  

  

    

    
      <a class="item" data-title="通过端口转发访问集群中的应用程序" href="/docs/tasks/access-application-cluster/port-forward-access-application-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="Provide Load-Balanced Access to an Application in a Cluster" href="/docs/tasks/access-application-cluster/load-balance-access-application-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 service 访问群集中的应用程序" href="/docs/tasks/access-application-cluster/service-access-application-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Service 把前端连接到后端" href="/docs/tasks/access-application-cluster/connecting-frontend-backend/"></a>
    
  

  

    

    
      <a class="item" data-title="创建一个外部负载均衡器" href="/docs/tasks/access-application-cluster/create-external-load-balancer/"></a>
    
  

  

    

    
      <a class="item" data-title="配置云平台防火墙" href="/docs/tasks/access-application-cluster/configure-cloud-provider-firewall/"></a>
    
  

  

    

    
      <a class="item" data-title="List All Container Images Running in a Cluster" href="/docs/tasks/access-application-cluster/list-all-running-container-images/"></a>
    
  

  

    

    
      <a class="item" data-title="同 Pod 内的容器使用共享卷通信" href="/docs/tasks/access-application-cluster/communicate-containers-same-pod-shared-volume/"></a>
    
  

  

    

    
      <a class="item" data-title="Configuring DNS for a Cluster" href="https://github.com/kubernetes/kubernetes/tree/release-1.5/examples/cluster-dns"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Monitor, Log, and Debug">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Core metrics pipeline" href="/docs/tasks/debug-application-cluster/core-metrics-pipeline/"></a>
    
  

  

    

    
      <a class="item" data-title="对计算、存储和网络资源进行监控的工具" href="/docs/tasks/debug-application-cluster/resource-usage-monitoring/"></a>
    
  

  

    

    
      <a class="item" data-title="获取一个运行容器的 Shell" href="/docs/tasks/debug-application-cluster/get-shell-running-container/"></a>
    
  

  

    

    
      <a class="item" data-title="监控节点健康状况" href="/docs/tasks/debug-application-cluster/monitor-node-health/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Stackdriver 查看日志" href="/docs/tasks/debug-application-cluster/logging-stackdriver/"></a>
    
  

  

    

    
      <a class="item" data-title="Stackdriver 中的事件" href="/docs/tasks/debug-application-cluster/events-stackdriver/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Elasticsearch 和 Kibana 查看日志" href="/docs/tasks/debug-application-cluster/logging-elasticsearch-kibana/"></a>
    
  

  

    

    
      <a class="item" data-title="确定 Pod 失败的原因" href="/docs/tasks/debug-application-cluster/determine-reason-pod-failure/"></a>
    
  

  

    

    
      <a class="item" data-title="调试 Init 容器" href="/docs/tasks/debug-application-cluster/debug-init-containers/"></a>
    
  

  

    

    
      <a class="item" data-title="Debug Pods and Replication Controllers" href="/docs/tasks/debug-application-cluster/debug-pod-replication-controller/"></a>
    
  

  

    

    
      <a class="item" data-title="Debug Services" href="/docs/tasks/debug-application-cluster/debug-service/"></a>
    
  

  

    

    
      <a class="item" data-title="Troubleshoot Clusters" href="/docs/tasks/debug-application-cluster/debug-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="Troubleshoot Applications" href="/docs/tasks/debug-application-cluster/debug-application/"></a>
    
  

  

    

    
      <a class="item" data-title="Debug a StatefulSet" href="/docs/tasks/debug-application-cluster/debug-stateful-set/"></a>
    
  

  

    

    
      <a class="item" data-title="Application Introspection and Debugging" href="/docs/tasks/debug-application-cluster/debug-application-introspection/"></a>
    
  

  

    

    
      <a class="item" data-title="Auditing" href="/docs/tasks/debug-application-cluster/audit/"></a>
    
  

  

    

    
      <a class="item" data-title="Developing and debugging services locally" href="/docs/tasks/debug-application-cluster/local-debugging/"></a>
    
  

  

    

    
      <a class="item" data-title="Use Explorer to Examine the Runtime Environment" href="https://github.com/kubernetes/kubernetes/tree/release-1.5/examples/explorer"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Extend Kubernetes">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Use an HTTP Proxy to Access the Kubernetes API" href="/docs/tasks/access-kubernetes-api/http-proxy-access-api/"></a>
    
  

  

    

    
      <a class="item" data-title="使用CRD(CustomResourceDefinitions)扩展Kubernetes API" href="/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/"></a>
    
  

  

    

    
      <a class="item" data-title="Extend the Kubernetes API with ThirdPartyResources" href="/docs/tasks/access-kubernetes-api/extend-api-third-party-resource/"></a>
    
  

  

    

    
      <a class="item" data-title="Migrate a ThirdPartyResource to CustomResourceDefinition" href="/docs/tasks/access-kubernetes-api/migrate-third-party-resource/"></a>
    
  

  

    

    
      <a class="item" data-title="Configure the aggregation layer" href="/docs/tasks/access-kubernetes-api/configure-aggregation-layer/"></a>
    
  

  

    

    
      <a class="item" data-title="配置扩展 API 服务器" href="/docs/tasks/access-kubernetes-api/setup-extension-api-server/"></a>
    
  

  

    

    
      <a class="item" data-title="Install Service Catalog using Helm" href="/docs/tasks/service-catalog/install-service-catalog-using-helm/"></a>
    
  

  

    

    
      <a class="item" data-title="Install Service Catalog using SC" href="/docs/tasks/service-catalog/install-service-catalog-using-sc/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="TLS">
      <div class="container">
        
  

    

    
      <a class="item" data-title="管理集群中的TLS认证" href="/docs/tasks/tls/managing-tls-in-a-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="证书轮换" href="/docs/tasks/tls/certificate-rotation/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Administer a Cluster">
      <div class="container">
        
  
    <div class="item" data-title="Manage Memory, CPU, and API Resources">
      <div class="container">
        
  

    

    
      <a class="item" data-title="为命名空间配置默认的内存请求与限额" href="/docs/tasks/administer-cluster/memory-default-namespace/"></a>
    
  

  

    

    
      <a class="item" data-title="在命名空间中配置默认的CPU请求与限额" href="/docs/tasks/administer-cluster/cpu-default-namespace/"></a>
    
  

  

    

    
      <a class="item" data-title="为 Namespace 设置最小和最大内存限制" href="/docs/tasks/administer-cluster/memory-constraint-namespace/"></a>
    
  

  

    

    
      <a class="item" data-title="为 Namespace 配置最小和最大 CPU 限制" href="/docs/tasks/administer-cluster/cpu-constraint-namespace/"></a>
    
  

  

    

    
      <a class="item" data-title="应用资源配额和限额" href="/docs/tasks/administer-cluster/apply-resource-quota-limit/"></a>
    
  

  

    

    
      <a class="item" data-title="为名字空间配置CPU和内存配额（Quota）" href="/docs/tasks/administer-cluster/quota-memory-cpu-namespace/"></a>
    
  

  

    

    
      <a class="item" data-title="为名字空间配置Pod配额" href="/docs/tasks/administer-cluster/quota-pod-namespace/"></a>
    
  

  

    

    
      <a class="item" data-title="配置API对象（API Object）的配额（Quota）" href="/docs/tasks/administer-cluster/quota-api-object/"></a>
    
  

  

    

    
      <a class="item" data-title="为节点发布不透明整数资源（Opaque Integer Resources）" href="/docs/tasks/administer-cluster/opaque-integer-resource-node/"></a>
    
  

  

    

    
      <a class="item" data-title="控制节点上的CPU管理策略" href="/docs/tasks/administer-cluster/cpu-management-policies/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="通过 Kubernetes API 访问集群" href="/docs/tasks/administer-cluster/access-cluster-api/"></a>
    
  

  

    

    
      <a class="item" data-title="访问集群上运行的服务" href="/docs/tasks/administer-cluster/access-cluster-services/"></a>
    
  

  

    

    
      <a class="item" data-title="集群安全" href="/docs/tasks/administer-cluster/securing-a-cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="Encrypting data at rest" href="/docs/tasks/administer-cluster/encrypt-data/"></a>
    
  

  

    

    
      <a class="item" data-title="Operating etcd clusters for Kubernetes" href="/docs/tasks/administer-cluster/configure-upgrade-etcd/"></a>
    
  

  

    

    
      <a class="item" data-title="静态 Pod" href="/docs/tasks/administer-cluster/static-pod/"></a>
    
  

  

    

    
      <a class="item" data-title="集群管理" href="/docs/tasks/administer-cluster/cluster-management/"></a>
    
  

  

    

    
      <a class="item" data-title="1.6 版本集群管理指南" href="/docs/tasks/administer-cluster/upgrade-1-6/"></a>
    
  

  

    

    
      <a class="item" data-title="将 kubeadm 集群从 1.6 升级到 1.7" href="/docs/tasks/administer-cluster/kubeadm-upgrade-1-7/"></a>
    
  

  

    

    
      <a class="item" data-title="将 kubeadm 集群从 1.7 升级到 1.8" href="/docs/tasks/administer-cluster/kubeadm-upgrade-1-8/"></a>
    
  

  

    

    
      <a class="item" data-title="使用命名空间共享一个集群" href="/docs/tasks/administer-cluster/namespaces/"></a>
    
  

  

    

    
      <a class="item" data-title="演示命名空间" href="/docs/tasks/administer-cluster/namespaces-walkthrough/"></a>
    
  

  

    

    
      <a class="item" data-title="集群 DNS Service Autoscale" href="/docs/tasks/administer-cluster/dns-horizontal-autoscaling/"></a>
    
  

  

    

    
      <a class="item" data-title="遵循应用中断预算安全移除节点" href="/docs/tasks/administer-cluster/safely-drain-node/"></a>
    
  

  

    

    
      <a class="item" data-title="设置 Pod CPU 和内存限制" href="/docs/tasks/administer-cluster/cpu-memory-limit/"></a>
    
  

  

    

    
      <a class="item" data-title="配置资源不足处理方式" href="/docs/tasks/administer-cluster/out-of-resource/"></a>
    
  

  

    

    
      <a class="item" data-title="为系统守护进程预留计算资源" href="/docs/tasks/administer-cluster/reserve-compute-resources/"></a>
    
  

  

    

    
      <a class="item" data-title="关键插件 Pod 的调度保证" href="/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/"></a>
    
  

  

    

    
      <a class="item" data-title="声明网络策略" href="/docs/tasks/administer-cluster/declare-network-policy/"></a>
    
  

  

    

    
      <a class="item" data-title="重新配置活动集群中节点的 Kubelet" href="/docs/tasks/administer-cluster/reconfigure-kubelet/"></a>
    
  

  

    

    
      <a class="item" data-title="通过配置文件设置 Kubelet 参数" href="/docs/tasks/administer-cluster/kubelet-config-file/"></a>
    
  

  
    <div class="item" data-title="Install Network Policy Provider">
      <div class="container">
        
  

    

    
      <a class="item" data-title="为了 NetworkPolicy 使用 Calico" href="/docs/tasks/administer-cluster/calico-network-policy/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Cilium 来提供 NetworkPolicy" href="/docs/tasks/administer-cluster/cilium-network-policy/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Kube-router 来提供 NetworkPolicy" href="/docs/tasks/administer-cluster/kube-router-network-policy/"></a>
    
  

  

    

    
      <a class="item" data-title="为了 NetworkPolicy 使用 Romana" href="/docs/tasks/administer-cluster/romana-network-policy/"></a>
    
  

  

    

    
      <a class="item" data-title="为了 NetworkPolicy 使用 Weave 网络" href="/docs/tasks/administer-cluster/weave-network-policy/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="更改 PersistentVolume 的回收策略" href="/docs/tasks/administer-cluster/change-pv-reclaim-policy/"></a>
    
  

  

    

    
  

  

    

    
      <a class="item" data-title="限制存储使用量" href="/docs/tasks/administer-cluster/limit-storage-consumption/"></a>
    
  

  

    

    
      <a class="item" data-title="改变默认 StorageClass" href="/docs/tasks/administer-cluster/change-default-storage-class/"></a>
    
  

  

    

    
      <a class="item" data-title="Kubernetes 云管理控制器" href="/docs/tasks/administer-cluster/running-cloud-controller/"></a>
    
  

  

    

    
      <a class="item" data-title="开发云管理控制器（Cloud Controller Manager）" href="/docs/tasks/administer-cluster/developing-cloud-controller-manager/"></a>
    
  

  

    

    
      <a class="item" data-title="建立高可用 Kubernetes Master" href="/docs/tasks/administer-cluster/highly-available-master/"></a>
    
  

  

    

    
      <a class="item" data-title="配置多个调度器" href="/docs/tasks/administer-cluster/configure-multiple-schedulers/"></a>
    
  

  

    

    
      <a class="item" data-title="IP 伪装代理用户指南" href="/docs/tasks/administer-cluster/ip-masq-agent/"></a>
    
  

  

    

    
      <a class="item" data-title="在 Kubernetes 中配置私有 DNS 和上游 nameserver" href="/docs/tasks/administer-cluster/dns-custom-nameservers/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Federation - Run an App on Multiple Clusters">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Cross-cluster Service Discovery using Federated Services" href="/docs/tasks/federation/federation-service-discovery/"></a>
    
  

  

    

    
      <a class="item" data-title="使用 Kubefed 创建集群联邦" href="/docs/tasks/federation/set-up-cluster-federation-kubefed/"></a>
    
  

  

    

    
      <a class="item" data-title="Set up CoreDNS as DNS provider for Cluster Federation" href="/docs/tasks/federation/set-up-coredns-provider-federation/"></a>
    
  

  

    

    
      <a class="item" data-title="Set up placement policies in Federation" href="/docs/tasks/federation/set-up-placement-policies-federation/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Cluster" href="/docs/tasks/administer-federation/cluster/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated ConfigMap" href="/docs/tasks/administer-federation/configmap/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated DaemonSet" href="/docs/tasks/administer-federation/daemonset/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Deployment" href="/docs/tasks/administer-federation/deployment/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Events" href="/docs/tasks/administer-federation/events/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Horizontal Pod Autoscalers (HPA)" href="/docs/tasks/administer-federation/hpa/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Ingress" href="/docs/tasks/administer-federation/ingress/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Jobs" href="/docs/tasks/administer-federation/job/"></a>
    
  

  

    

    
      <a class="item" data-title="联邦命名空间" href="/docs/tasks/administer-federation/namespaces/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated ReplicaSets" href="/docs/tasks/administer-federation/replicaset/"></a>
    
  

  

    

    
      <a class="item" data-title="Federated Secrets" href="/docs/tasks/administer-federation/secret/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Manage Cluster Daemons">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Perform a Rolling Update on a DaemonSet" href="/docs/tasks/manage-daemon/update-daemon-set/"></a>
    
  

  

    

    
      <a class="item" data-title="对 DaemonSet 执行回滚" href="/docs/tasks/manage-daemon/rollback-daemon-set/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Manage GPUs">
      <div class="container">
        
  

    

    
      <a class="item" data-title="调度 GPU" href="/docs/tasks/manage-gpus/scheduling-gpus/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Manage HugePages">
      <div class="container">
        
  

    

    
      <a class="item" data-title="管理巨页（HugePages）" href="/docs/tasks/manage-hugepages/scheduling-hugepages/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Extend kubectl with plugins">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Extend kubectl with plugins" href="/docs/tasks/extend-kubectl/kubectl-plugins/"></a>
    
  


      </div>
    </div>
  


        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/tasks/debug-application-cluster/debug-service.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Debug Services</h1>
        

        <p>An issue that comes up rather frequently for new installations of Kubernetes is
that <code class="highlighter-rouge">Services</code> are not working properly.  You’ve run all your <code class="highlighter-rouge">Pods</code> and
<code class="highlighter-rouge">Deployments</code>, but you get no response when you try to access them.
This document will hopefully help you to figure out what’s going wrong.</p>

<ul id="markdown-toc">
  <li><a href="#conventions" id="markdown-toc-conventions">Conventions</a></li>
  <li><a href="#running-commands-in-a-pod" id="markdown-toc-running-commands-in-a-pod">Running commands in a Pod</a></li>
  <li><a href="#setup" id="markdown-toc-setup">Setup</a></li>
  <li><a href="#does-the-service-exist" id="markdown-toc-does-the-service-exist">Does the Service exist?</a></li>
  <li><a href="#does-the-service-work-by-dns" id="markdown-toc-does-the-service-work-by-dns">Does the Service work by DNS?</a>    <ul>
      <li><a href="#does-any-service-exist-in-dns" id="markdown-toc-does-any-service-exist-in-dns">Does any Service exist in DNS?</a></li>
    </ul>
  </li>
  <li><a href="#does-the-service-work-by-ip" id="markdown-toc-does-the-service-work-by-ip">Does the Service work by IP?</a></li>
  <li><a href="#is-the-service-correct" id="markdown-toc-is-the-service-correct">Is the Service correct?</a></li>
  <li><a href="#does-the-service-have-any-endpoints" id="markdown-toc-does-the-service-have-any-endpoints">Does the Service have any Endpoints?</a></li>
  <li><a href="#are-the-pods-working" id="markdown-toc-are-the-pods-working">Are the Pods working?</a></li>
  <li><a href="#is-the-kube-proxy-working" id="markdown-toc-is-the-kube-proxy-working">Is the kube-proxy working?</a>    <ul>
      <li><a href="#is-kube-proxy-running" id="markdown-toc-is-kube-proxy-running">Is kube-proxy running?</a></li>
      <li><a href="#is-kube-proxy-writing-iptables-rules" id="markdown-toc-is-kube-proxy-writing-iptables-rules">Is kube-proxy writing iptables rules?</a>        <ul>
          <li><a href="#userspace" id="markdown-toc-userspace">Userspace</a></li>
          <li><a href="#iptables" id="markdown-toc-iptables">Iptables</a></li>
        </ul>
      </li>
      <li><a href="#is-kube-proxy-proxying" id="markdown-toc-is-kube-proxy-proxying">Is kube-proxy proxying?</a></li>
      <li><a href="#my-service-is-missing-endpoints" id="markdown-toc-my-service-is-missing-endpoints">My service is missing endpoints</a></li>
      <li><a href="#network-traffic-is-not-forwarded" id="markdown-toc-network-traffic-is-not-forwarded">Network traffic is not forwarded</a></li>
      <li><a href="#a-pod-cannot-reach-itself-via-service-ip" id="markdown-toc-a-pod-cannot-reach-itself-via-service-ip">A Pod cannot reach itself via Service IP</a></li>
    </ul>
  </li>
  <li><a href="#seek-help" id="markdown-toc-seek-help">Seek help</a></li>
  <li><a href="#more-information" id="markdown-toc-more-information">More information</a></li>
</ul>

<h2 id="conventions">Conventions</h2>

<p>Throughout this doc you will see various commands that you can run.  Some
commands need to be run within a <code class="highlighter-rouge">Pod</code>, others on a Kubernetes <code class="highlighter-rouge">Node</code>, and others
can run anywhere you have <code class="highlighter-rouge">kubectl</code> and credentials for the cluster.  To make it
clear what is expected, this document will use the following conventions.</p>

<p>If the command “COMMAND” is expected to run in a <code class="highlighter-rouge">Pod</code> and produce “OUTPUT”:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>COMMAND
OUTPUT
</code></pre></div></div>

<p>If the command “COMMAND” is expected to run on a <code class="highlighter-rouge">Node</code> and produce “OUTPUT”:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>COMMAND
OUTPUT
</code></pre></div></div>

<p>If the command is “kubectl ARGS”:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl ARGS
OUTPUT
</code></pre></div></div>

<h2 id="running-commands-in-a-pod">Running commands in a Pod</h2>

<p>For many steps here you will want to see what a <code class="highlighter-rouge">Pod</code> running in the cluster
sees.  You can start a busybox <code class="highlighter-rouge">Pod</code> and run commands in it:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl run <span class="nt">-i</span> <span class="nt">--tty</span> busybox <span class="nt">--image</span><span class="o">=</span>busybox <span class="nt">--generator</span><span class="o">=</span><span class="s2">"run-pod/v1"</span>
Waiting <span class="k">for </span>pod default/busybox to be running, status is Pending, pod ready: <span class="nb">false

</span>Hit enter <span class="k">for </span><span class="nb">command </span>prompt

/ <span class="c">#</span>
</code></pre></div></div>

<p>If you already have a running <code class="highlighter-rouge">Pod</code>, run a command in it using:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl <span class="nb">exec</span> &lt;POD-NAME&gt; <span class="nt">-c</span> &lt;CONTAINER-NAME&gt; <span class="nt">--</span> &lt;COMMAND&gt;
</code></pre></div></div>

<p>or run an interactive shell with:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-ti</span> &lt;POD-NAME&gt; <span class="nt">-c</span> &lt;CONTAINER-NAME&gt; sh
/ <span class="c">#</span>
</code></pre></div></div>

<h2 id="setup">Setup</h2>

<p>For the purposes of this walk-through, let’s run some <code class="highlighter-rouge">Pods</code>.  Since you’re
probably debugging your own <code class="highlighter-rouge">Service</code> you can substitute your own details, or you
can follow along and get a second data point.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl run hostnames <span class="nt">--image</span><span class="o">=</span>gcr.io/google_containers/serve_hostname <span class="se">\</span>
                        <span class="nt">--labels</span><span class="o">=</span><span class="nv">app</span><span class="o">=</span>hostnames <span class="se">\</span>
                        <span class="nt">--port</span><span class="o">=</span>9376 <span class="se">\</span>
                        <span class="nt">--replicas</span><span class="o">=</span>3
deployment <span class="s2">"hostnames"</span> created
</code></pre></div></div>

<p><code class="highlighter-rouge">kubectl</code> commands will print the type and name of the resource created or mutated, which can then be used in subsequent commands.
Note that this is the same as if you had started the <code class="highlighter-rouge">Deployment</code> with
the following YAML:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">extensions/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hostnames</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">hostnames</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="s">3</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">hostnames</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">hostnames</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">gcr.io/google_containers/serve_hostname</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="s">9376</span>
          <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
</code></pre></div></div>

<p>Confirm your <code class="highlighter-rouge">Pods</code> are running:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get pods <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>hostnames
NAME                        READY     STATUS    RESTARTS   AGE
hostnames-632524106-bbpiw   1/1       Running   0          2m
hostnames-632524106-ly40y   1/1       Running   0          2m
hostnames-632524106-tlaok   1/1       Running   0          2m
</code></pre></div></div>

<h2 id="does-the-service-exist">Does the Service exist?</h2>

<p>The astute reader will have noticed that we did not actually create a <code class="highlighter-rouge">Service</code>
yet - that is intentional.  This is a step that sometimes gets forgotten, and
is the first thing to check.</p>

<p>So what would happen if I tried to access a non-existent <code class="highlighter-rouge">Service</code>?  Assuming you
have another <code class="highlighter-rouge">Pod</code> that consumes this <code class="highlighter-rouge">Service</code> by name you would get something
like:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>wget <span class="nt">-qO-</span> hostnames
wget: bad address <span class="s1">'hostname'</span>
</code></pre></div></div>

<p>or:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$HOSTNAMES_SERVICE_HOST</span>
</code></pre></div></div>

<p>So the first thing to check is whether that <code class="highlighter-rouge">Service</code> actually exists:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get svc hostnames
Error from server <span class="o">(</span>NotFound<span class="o">)</span>: services <span class="s2">"hostnames"</span> not found
</code></pre></div></div>

<p>So we have a culprit, let’s create the <code class="highlighter-rouge">Service</code>.  As before, this is for the
walk-through - you can use your own <code class="highlighter-rouge">Service</code>’s details here.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl expose deployment hostnames <span class="nt">--port</span><span class="o">=</span>80 <span class="nt">--target-port</span><span class="o">=</span>9376
service <span class="s2">"hostnames"</span> exposed
</code></pre></div></div>

<p>And read it back, just to be sure:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get svc hostnames
NAME        CLUSTER-IP   EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>   AGE
hostnames   10.0.0.226   &lt;none&gt;        80/TCP    5s
</code></pre></div></div>

<p>As before, this is the same as if you had started the <code class="highlighter-rouge">Service</code> with YAML:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hostnames</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">hostnames</span>
  <span class="na">ports</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
    <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
    <span class="na">port</span><span class="pi">:</span> <span class="s">80</span>
    <span class="na">targetPort</span><span class="pi">:</span> <span class="s">9376</span>
</code></pre></div></div>

<p>Now you can confirm that the <code class="highlighter-rouge">Service</code> exists.</p>

<h2 id="does-the-service-work-by-dns">Does the Service work by DNS?</h2>

<p>From a <code class="highlighter-rouge">Pod</code> in the same <code class="highlighter-rouge">Namespace</code>:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>nslookup hostnames
Server:         10.0.0.10
Address:        10.0.0.10#53

Name:   hostnames
Address: 10.0.1.175
</code></pre></div></div>

<p>If this fails, perhaps your <code class="highlighter-rouge">Pod</code> and <code class="highlighter-rouge">Service</code> are in different
<code class="highlighter-rouge">Namespaces</code>, try a namespace-qualified name:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>nslookup hostnames.default
Server:         10.0.0.10
Address:        10.0.0.10#53

Name:   hostnames.default
Address: 10.0.1.175
</code></pre></div></div>

<p>If this works, you’ll need to ensure that <code class="highlighter-rouge">Pods</code> and <code class="highlighter-rouge">Services</code> run in the same
<code class="highlighter-rouge">Namespace</code>.  If this still fails, try a fully-qualified name:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>nslookup hostnames.default.svc.cluster.local
Server:         10.0.0.10
Address:        10.0.0.10#53

Name:   hostnames.default.svc.cluster.local
Address: 10.0.1.175
</code></pre></div></div>

<p>Note the suffix here: “default.svc.cluster.local”.  The “default” is the
<code class="highlighter-rouge">Namespace</code> we’re operating in.  The “svc” denotes that this is a <code class="highlighter-rouge">Service</code>.
The “cluster.local” is your cluster domain.</p>

<p>You can also try this from a <code class="highlighter-rouge">Node</code> in the cluster (note: 10.0.0.10 is my DNS
<code class="highlighter-rouge">Service</code>):</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>nslookup hostnames.default.svc.cluster.local 10.0.0.10
Server:         10.0.0.10
Address:        10.0.0.10#53

Name:   hostnames.default.svc.cluster.local
Address: 10.0.1.175
</code></pre></div></div>

<p>If you are able to do a fully-qualified name lookup but not a relative one, you
need to check that your <code class="highlighter-rouge">kubelet</code> is running with the right flags.
The <code class="highlighter-rouge">--cluster-dns</code> flag needs to point to your DNS <code class="highlighter-rouge">Service</code>’s IP and the
<code class="highlighter-rouge">--cluster-domain</code> flag needs to be your cluster’s domain - we assumed
“cluster.local” in this document, but yours might be different, in which case
you should change that in all of the commands above.</p>

<h3 id="does-any-service-exist-in-dns">Does any Service exist in DNS?</h3>

<p>If the above still fails - DNS lookups are not working for your <code class="highlighter-rouge">Service</code> - we
can take a step back and see what else is not working.  The Kubernetes master
<code class="highlighter-rouge">Service</code> should always work:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>nslookup kubernetes.default
Server:    10.0.0.10
Address 1: 10.0.0.10

Name:      kubernetes
Address 1: 10.0.0.1
</code></pre></div></div>

<p>If this fails, you might need to go to the kube-proxy section of this doc, or
even go back to the top of this document and start over, but instead of
debugging your own <code class="highlighter-rouge">Service</code>, debug DNS.</p>

<h2 id="does-the-service-work-by-ip">Does the Service work by IP?</h2>

<p>The next thing to test is whether your <code class="highlighter-rouge">Service</code> works at all.  From a
<code class="highlighter-rouge">Node</code> in your cluster, access the <code class="highlighter-rouge">Service</code>’s IP (from <code class="highlighter-rouge">kubectl get</code> above).</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>curl 10.0.1.175:80
hostnames-0uton

u@node<span class="nv">$ </span>curl 10.0.1.175:80
hostnames-yp2kp

u@node<span class="nv">$ </span>curl 10.0.1.175:80
hostnames-bvc05
</code></pre></div></div>

<p>If your <code class="highlighter-rouge">Service</code> is working, you should get correct responses.  If not, there
are a number of things that could be going wrong.  Read on.</p>

<h2 id="is-the-service-correct">Is the Service correct?</h2>

<p>It might sound silly, but you should really double and triple check that your
<code class="highlighter-rouge">Service</code> is correct and matches your <code class="highlighter-rouge">Pods</code>.  Read back your <code class="highlighter-rouge">Service</code> and
verify it:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get service hostnames <span class="nt">-o</span> json
<span class="o">{</span>
    <span class="s2">"kind"</span>: <span class="s2">"Service"</span>,
    <span class="s2">"apiVersion"</span>: <span class="s2">"v1"</span>,
    <span class="s2">"metadata"</span>: <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"hostnames"</span>,
        <span class="s2">"namespace"</span>: <span class="s2">"default"</span>,
        <span class="s2">"selfLink"</span>: <span class="s2">"/api/v1/namespaces/default/services/hostnames"</span>,
        <span class="s2">"uid"</span>: <span class="s2">"428c8b6c-24bc-11e5-936d-42010af0a9bc"</span>,
        <span class="s2">"resourceVersion"</span>: <span class="s2">"347189"</span>,
        <span class="s2">"creationTimestamp"</span>: <span class="s2">"2015-07-07T15:24:29Z"</span>,
        <span class="s2">"labels"</span>: <span class="o">{</span>
            <span class="s2">"app"</span>: <span class="s2">"hostnames"</span>
        <span class="o">}</span>
    <span class="o">}</span>,
    <span class="s2">"spec"</span>: <span class="o">{</span>
        <span class="s2">"ports"</span>: <span class="o">[</span>
            <span class="o">{</span>
                <span class="s2">"name"</span>: <span class="s2">"default"</span>,
                <span class="s2">"protocol"</span>: <span class="s2">"TCP"</span>,
                <span class="s2">"port"</span>: 80,
                <span class="s2">"targetPort"</span>: 9376,
                <span class="s2">"nodePort"</span>: 0
            <span class="o">}</span>
        <span class="o">]</span>,
        <span class="s2">"selector"</span>: <span class="o">{</span>
            <span class="s2">"app"</span>: <span class="s2">"hostnames"</span>
        <span class="o">}</span>,
        <span class="s2">"clusterIP"</span>: <span class="s2">"10.0.1.175"</span>,
        <span class="s2">"type"</span>: <span class="s2">"ClusterIP"</span>,
        <span class="s2">"sessionAffinity"</span>: <span class="s2">"None"</span>
    <span class="o">}</span>,
    <span class="s2">"status"</span>: <span class="o">{</span>
        <span class="s2">"loadBalancer"</span>: <span class="o">{}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Is the port you are trying to access in <code class="highlighter-rouge">spec.ports[]</code>?  Is the <code class="highlighter-rouge">targetPort</code>
correct for your <code class="highlighter-rouge">Pods</code>?  If you meant it to be a numeric port, is it a number
(9376) or a string “9376”?  If you meant it to be a named port, do your <code class="highlighter-rouge">Pods</code>
expose a port with the same name?  Is the port’s <code class="highlighter-rouge">protocol</code> the same as the
<code class="highlighter-rouge">Pod</code>’s?</p>

<h2 id="does-the-service-have-any-endpoints">Does the Service have any Endpoints?</h2>

<p>If you got this far, we assume that you have confirmed that your <code class="highlighter-rouge">Service</code>
exists and is resolved by DNS.  Now let’s check that the <code class="highlighter-rouge">Pods</code> you ran are
actually being selected by the <code class="highlighter-rouge">Service</code>.</p>

<p>Earlier we saw that the <code class="highlighter-rouge">Pods</code> were running.  We can re-check that:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get pods <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>hostnames
NAME              READY     STATUS    RESTARTS   AGE
hostnames-0uton   1/1       Running   0          1h
hostnames-bvc05   1/1       Running   0          1h
hostnames-yp2kp   1/1       Running   0          1h
</code></pre></div></div>

<p>The “AGE” column says that these <code class="highlighter-rouge">Pods</code> are about an hour old, which implies that
they are running fine and not crashing.</p>

<p>The <code class="highlighter-rouge">-l app=hostnames</code> argument is a label selector - just like our <code class="highlighter-rouge">Service</code>
has.  Inside the Kubernetes system is a control loop which evaluates the
selector of every <code class="highlighter-rouge">Service</code> and saves the results into an <code class="highlighter-rouge">Endpoints</code> object.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get endpoints hostnames
NAME        ENDPOINTS
hostnames   10.244.0.5:9376,10.244.0.6:9376,10.244.0.7:9376
</code></pre></div></div>

<p>This confirms that the control loop has found the correct <code class="highlighter-rouge">Pods</code> for your
<code class="highlighter-rouge">Service</code>.  If the <code class="highlighter-rouge">hostnames</code> row is blank, you should check that the
<code class="highlighter-rouge">spec.selector</code> field of your <code class="highlighter-rouge">Service</code> actually selects for <code class="highlighter-rouge">metadata.labels</code>
values on your <code class="highlighter-rouge">Pods</code>.</p>

<h2 id="are-the-pods-working">Are the Pods working?</h2>

<p>At this point, we know that your <code class="highlighter-rouge">Service</code> exists and has selected your <code class="highlighter-rouge">Pods</code>.
Let’s check that the <code class="highlighter-rouge">Pods</code> are actually working - we can bypass the <code class="highlighter-rouge">Service</code>
mechanism and go straight to the <code class="highlighter-rouge">Pods</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@pod<span class="nv">$ </span>wget <span class="nt">-qO-</span> 10.244.0.5:9376
hostnames-0uton

pod <span class="nv">$ </span>wget <span class="nt">-qO-</span> 10.244.0.6:9376
hostnames-bvc05

u@pod<span class="nv">$ </span>wget <span class="nt">-qO-</span> 10.244.0.7:9376
hostnames-yp2kp
</code></pre></div></div>

<p>We expect each <code class="highlighter-rouge">Pod</code> in the <code class="highlighter-rouge">Endpoints</code> list to return its own hostname.  If
this is not what happens (or whatever the correct behavior is for your own
<code class="highlighter-rouge">Pods</code>), you should investigate what’s happening there.  You might find
<code class="highlighter-rouge">kubectl logs</code> to be useful or <code class="highlighter-rouge">kubectl exec</code> directly to your <code class="highlighter-rouge">Pods</code> and check
service from there.</p>

<h2 id="is-the-kube-proxy-working">Is the kube-proxy working?</h2>

<p>If you get here, your <code class="highlighter-rouge">Service</code> is running, has <code class="highlighter-rouge">Endpoints</code>, and your <code class="highlighter-rouge">Pods</code>
are actually serving.  At this point, the whole <code class="highlighter-rouge">Service</code> proxy mechanism is
suspect.  Let’s confirm it, piece by piece.</p>

<h3 id="is-kube-proxy-running">Is kube-proxy running?</h3>

<p>Confirm that <code class="highlighter-rouge">kube-proxy</code> is running on your <code class="highlighter-rouge">Nodes</code>.  You should get something
like the below:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>ps auxw | <span class="nb">grep </span>kube-proxy
root  4194  0.4  0.1 101864 17696 ?    Sl Jul04  25:43 /usr/local/bin/kube-proxy <span class="nt">--master</span><span class="o">=</span>https://kubernetes-master <span class="nt">--kubeconfig</span><span class="o">=</span>/var/lib/kube-proxy/kubeconfig <span class="nt">--v</span><span class="o">=</span>2
</code></pre></div></div>

<p>Next, confirm that it is not failing something obvious, like contacting the
master.  To do this, you’ll have to look at the logs.  Accessing the logs
depends on your <code class="highlighter-rouge">Node</code> OS.  On some OSes it is a file, such as
/var/log/kube-proxy.log, while other OSes use <code class="highlighter-rouge">journalctl</code> to access logs.  You
should see something like:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I1027 22:14:53.995134    5063 server.go:200] Running <span class="k">in </span>resource-only container <span class="s2">"/kube-proxy"</span>
I1027 22:14:53.998163    5063 server.go:247] Using iptables Proxier.
I1027 22:14:53.999055    5063 server.go:255] Tearing down userspace rules. Errors here are acceptable.
I1027 22:14:54.038140    5063 proxier.go:352] Setting endpoints <span class="k">for</span> <span class="s2">"kube-system/kube-dns:dns-tcp"</span> to <span class="o">[</span>10.244.1.3:53]
I1027 22:14:54.038164    5063 proxier.go:352] Setting endpoints <span class="k">for</span> <span class="s2">"kube-system/kube-dns:dns"</span> to <span class="o">[</span>10.244.1.3:53]
I1027 22:14:54.038209    5063 proxier.go:352] Setting endpoints <span class="k">for</span> <span class="s2">"default/kubernetes:https"</span> to <span class="o">[</span>10.240.0.2:443]
I1027 22:14:54.038238    5063 proxier.go:429] Not syncing iptables <span class="k">until </span>Services and Endpoints have been received from master
I1027 22:14:54.040048    5063 proxier.go:294] Adding new service <span class="s2">"default/kubernetes:https"</span> at 10.0.0.1:443/TCP
I1027 22:14:54.040154    5063 proxier.go:294] Adding new service <span class="s2">"kube-system/kube-dns:dns"</span> at 10.0.0.10:53/UDP
I1027 22:14:54.040223    5063 proxier.go:294] Adding new service <span class="s2">"kube-system/kube-dns:dns-tcp"</span> at 10.0.0.10:53/TCP
</code></pre></div></div>

<p>If you see error messages about not being able to contact the master, you
should double-check your <code class="highlighter-rouge">Node</code> configuration and installation steps.</p>

<h3 id="is-kube-proxy-writing-iptables-rules">Is kube-proxy writing iptables rules?</h3>

<p>One of the main responsibilities of <code class="highlighter-rouge">kube-proxy</code> is to write the <code class="highlighter-rouge">iptables</code>
rules which implement <code class="highlighter-rouge">Services</code>.  Let’s check that those rules are getting
written.</p>

<p>The kube-proxy can run in either “userspace” mode or “iptables” mode.
Hopefully you are using the newer, faster, more stable “iptables” mode.  You
should see one of the following cases.</p>

<h4 id="userspace">Userspace</h4>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>iptables-save | <span class="nb">grep </span>hostnames
<span class="nt">-A</span> KUBE-PORTALS-CONTAINER <span class="nt">-d</span> 10.0.1.175/32 <span class="nt">-p</span> tcp <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:default"</span> <span class="nt">-m</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> REDIRECT <span class="nt">--to-ports</span> 48577
<span class="nt">-A</span> KUBE-PORTALS-HOST <span class="nt">-d</span> 10.0.1.175/32 <span class="nt">-p</span> tcp <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:default"</span> <span class="nt">-m</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> DNAT <span class="nt">--to-destination</span> 10.240.115.247:48577
</code></pre></div></div>

<p>There should be 2 rules for each port on your <code class="highlighter-rouge">Service</code> (just one in this
example) - a “KUBE-PORTALS-CONTAINER” and a “KUBE-PORTALS-HOST”.  If you do
not see these, try restarting <code class="highlighter-rouge">kube-proxy</code> with the <code class="highlighter-rouge">-V</code> flag set to 4, and
then look at the logs again.</p>

<h4 id="iptables">Iptables</h4>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>iptables-save | <span class="nb">grep </span>hostnames
<span class="nt">-A</span> KUBE-SEP-57KPRZ3JQVENLNBR <span class="nt">-s</span> 10.244.3.6/32 <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-j</span> MARK <span class="nt">--set-xmark</span> 0x00004000/0x00004000
<span class="nt">-A</span> KUBE-SEP-57KPRZ3JQVENLNBR <span class="nt">-p</span> tcp <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-m</span> tcp <span class="nt">-j</span> DNAT <span class="nt">--to-destination</span> 10.244.3.6:9376
<span class="nt">-A</span> KUBE-SEP-WNBA2IHDGP2BOBGZ <span class="nt">-s</span> 10.244.1.7/32 <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-j</span> MARK <span class="nt">--set-xmark</span> 0x00004000/0x00004000
<span class="nt">-A</span> KUBE-SEP-WNBA2IHDGP2BOBGZ <span class="nt">-p</span> tcp <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-m</span> tcp <span class="nt">-j</span> DNAT <span class="nt">--to-destination</span> 10.244.1.7:9376
<span class="nt">-A</span> KUBE-SEP-X3P2623AGDH6CDF3 <span class="nt">-s</span> 10.244.2.3/32 <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-j</span> MARK <span class="nt">--set-xmark</span> 0x00004000/0x00004000
<span class="nt">-A</span> KUBE-SEP-X3P2623AGDH6CDF3 <span class="nt">-p</span> tcp <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-m</span> tcp <span class="nt">-j</span> DNAT <span class="nt">--to-destination</span> 10.244.2.3:9376
<span class="nt">-A</span> KUBE-SERVICES <span class="nt">-d</span> 10.0.1.175/32 <span class="nt">-p</span> tcp <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames: cluster IP"</span> <span class="nt">-m</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> KUBE-SVC-NWV5X2332I4OT4T3
<span class="nt">-A</span> KUBE-SVC-NWV5X2332I4OT4T3 <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-m</span> statistic <span class="nt">--mode</span> random <span class="nt">--probability</span> 0.33332999982 <span class="nt">-j</span> KUBE-SEP-WNBA2IHDGP2BOBGZ
<span class="nt">-A</span> KUBE-SVC-NWV5X2332I4OT4T3 <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-m</span> statistic <span class="nt">--mode</span> random <span class="nt">--probability</span> 0.50000000000 <span class="nt">-j</span> KUBE-SEP-X3P2623AGDH6CDF3
<span class="nt">-A</span> KUBE-SVC-NWV5X2332I4OT4T3 <span class="nt">-m</span> comment <span class="nt">--comment</span> <span class="s2">"default/hostnames:"</span> <span class="nt">-j</span> KUBE-SEP-57KPRZ3JQVENLNBR
</code></pre></div></div>

<p>There should be 1 rule in <code class="highlighter-rouge">KUBE-SERVICES</code>, 1 or 2 rules per endpoint in
<code class="highlighter-rouge">KUBE-SVC-(hash)</code> (depending on <code class="highlighter-rouge">SessionAffinity</code>), one <code class="highlighter-rouge">KUBE-SEP-(hash)</code> chain
per endpoint, and a few rules in each <code class="highlighter-rouge">KUBE-SEP-(hash)</code> chain.  The exact rules
will vary based on your exact config (including node-ports and load-balancers).</p>

<h3 id="is-kube-proxy-proxying">Is kube-proxy proxying?</h3>

<p>Assuming you do see the above rules, try again to access your <code class="highlighter-rouge">Service</code> by IP:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>curl 10.0.1.175:80
hostnames-0uton
</code></pre></div></div>

<p>If this fails and you are using the userspace proxy, you can try accessing the
proxy directly.  If you are using the iptables proxy, skip this section.</p>

<p>Look back at the <code class="highlighter-rouge">iptables-save</code> output above, and extract the
port number that <code class="highlighter-rouge">kube-proxy</code> is using for your <code class="highlighter-rouge">Service</code>.  In the above
examples it is “48577”.  Now connect to that:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>curl localhost:48577
hostnames-yp2kp
</code></pre></div></div>

<p>If this still fails, look at the <code class="highlighter-rouge">kube-proxy</code> logs for specific lines like:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Setting endpoints <span class="k">for </span>default/hostnames:default to <span class="o">[</span>10.244.0.5:9376 10.244.0.6:9376 10.244.0.7:9376]
</code></pre></div></div>

<p>If you don’t see those, try restarting <code class="highlighter-rouge">kube-proxy</code> with the <code class="highlighter-rouge">-V</code> flag set to 4, and
then look at the logs again.</p>

<p>Services provide load balancing across a set of pods. There are several common
problems that can make services not work properly. The following instructions
should help debug service problems.</p>

<p>First, verify that there are endpoints for the service. For every service
object, the apiserver makes an <code class="highlighter-rouge">endpoints</code> resource available.</p>

<p>You can view this resource with:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ kubectl get endpoints ${SERVICE_NAME}
</code></pre></div></div>

<p>Make sure that the endpoints match up with the number of containers that you
expect to be a member of your service. For example, if your service is for an
nginx container with 3 replicas, you would expect to see three different IP
addresses in the service’s endpoints.</p>

<h3 id="my-service-is-missing-endpoints">My service is missing endpoints</h3>

<p>If you are missing endpoints, try listing pods using the labels that service
uses. Imagine that you have a service where the labels are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
spec:
  - selector:
     name: nginx
     type: frontend
</code></pre></div></div>

<p>You can use:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ kubectl get pods --selector=name=nginx,type=frontend
</code></pre></div></div>

<p>to list pods that match this selector. Verify that the list matches the pods
that you expect to provide your service.</p>

<p>If the list of pods matches expectations, but your endpoints are still empty,
it’s possible that you don’t have the right ports exposed. If your service has
a <code class="highlighter-rouge">containerPort</code> specified, but the pods that are selected don’t have that
port listed, then they won’t be added to the endpoints list.</p>

<p>Verify that the pod’s <code class="highlighter-rouge">containerPort</code> matches up with the service’s
<code class="highlighter-rouge">containerPort</code>.</p>

<h3 id="network-traffic-is-not-forwarded">Network traffic is not forwarded</h3>

<p>If you can connect to the service, but the connection is immediately dropped,
and there are endpoints in the endpoints list, it’s likely that the proxy can’t
contact your pods.</p>

<p>There are three things to check:</p>

<ul>
  <li>
    <p>Are your pods working correctly?  Look for restart count, and
<a href="/docs/tasks/debug-application-cluster/debug-pod-replication-controller/#debugging-pods">debug pods</a>.</p>
  </li>
  <li>
    <p>Can you connect to your pods directly?  Get the IP address for the pod, and
try to connect directly to that IP.</p>
  </li>
  <li>
    <p>Is your application serving on the port that you configured? Container
Engine doesn’t do port remapping, so if your application serves on 8080,
the <code class="highlighter-rouge">containerPort</code> field needs to be 8080.</p>
  </li>
</ul>

<h3 id="a-pod-cannot-reach-itself-via-service-ip">A Pod cannot reach itself via Service IP</h3>

<p>This mostly happens when <code class="highlighter-rouge">kube-proxy</code> is running in <code class="highlighter-rouge">iptables</code> mode and Pods
are connected with bridge network. The <code class="highlighter-rouge">Kubelet</code> exposes a <code class="highlighter-rouge">hairpin-mode</code>
<a href="/docs/admin/kubelet/">flag</a> that allows endpoints of a Service to loadbalance back to themselves
if they try to access their own Service VIP. The <code class="highlighter-rouge">hairpin-mode</code> flag must either be
set to <code class="highlighter-rouge">hairpin-veth</code> or <code class="highlighter-rouge">promiscuous-bridge</code>.</p>

<p>The common steps to trouble shoot this are as follows:</p>

<ul>
  <li>Confirm <code class="highlighter-rouge">hairpin-mode</code> is set to <code class="highlighter-rouge">hairpin-veth</code> or <code class="highlighter-rouge">promiscuous-bridge</code>.
You should see something like the below. <code class="highlighter-rouge">hairpin-mode</code> is set to
<code class="highlighter-rouge">promiscuous-bridge</code> in the following example.</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>ps auxw|grep kubelet
root      3392  1.1  0.8 186804 65208 ?        Sl   00:51  11:11 /usr/local/bin/kubelet <span class="nt">--enable-debugging-handlers</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--config</span><span class="o">=</span>/etc/kubernetes/manifests <span class="nt">--allow-privileged</span><span class="o">=</span>True <span class="nt">--v</span><span class="o">=</span>4 <span class="nt">--cluster-dns</span><span class="o">=</span>10.0.0.10 <span class="nt">--cluster-domain</span><span class="o">=</span>cluster.local <span class="nt">--configure-cbr0</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--cgroup-root</span><span class="o">=</span>/ <span class="nt">--system-cgroups</span><span class="o">=</span>/system <span class="nt">--hairpin-mode</span><span class="o">=</span>promiscuous-bridge <span class="nt">--runtime-cgroups</span><span class="o">=</span>/docker-daemon <span class="nt">--kubelet-cgroups</span><span class="o">=</span>/kubelet <span class="nt">--babysit-daemons</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--max-pods</span><span class="o">=</span>110 <span class="nt">--serialize-image-pulls</span><span class="o">=</span><span class="nb">false</span> <span class="nt">--outofdisk-transition-frequency</span><span class="o">=</span>0

</code></pre></div></div>

<ul>
  <li>Confirm the effective <code class="highlighter-rouge">hairpin-mode</code>. To do this, you’ll have to look at
kubelet log. Accessing the logs depends on your Node OS. On some OSes it
is a file, such as /var/log/kubelet.log, while other OSes use <code class="highlighter-rouge">journalctl</code>
to access logs. Please be noted that the effective hairpin mode may not
match <code class="highlighter-rouge">--hairpin-mode</code> flag due to compatibility. Check if there is any log
lines with key word <code class="highlighter-rouge">hairpin</code> in kubelet.log. There should be log lines
indicating the effective hairpin mode, like something below.</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I0629 00:51:43.648698    3252 kubelet.go:380] Hairpin mode <span class="nb">set </span>to <span class="s2">"promiscuous-bridge"</span>
</code></pre></div></div>

<ul>
  <li>If the effective hairpin mode is <code class="highlighter-rouge">hairpin-veth</code>, ensure the <code class="highlighter-rouge">Kubelet</code> has
the permission to operate in <code class="highlighter-rouge">/sys</code> on node. If everything works properly,
you should see something like:</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span><span class="k">for </span>intf <span class="k">in</span> /sys/devices/virtual/net/cbr0/brif/<span class="k">*</span><span class="p">;</span> <span class="k">do </span><span class="nb">cat</span> <span class="nv">$intf</span>/hairpin_mode<span class="p">;</span> <span class="k">done
</span>1
1
1
1
</code></pre></div></div>

<ul>
  <li>If the effective hairpin mode is <code class="highlighter-rouge">promiscuous-bridge</code>, ensure <code class="highlighter-rouge">Kubelet</code>
has the permission to manipulate linux bridge on node. If cbr0` bridge is
used and configured properly, you should see:</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>u@node<span class="nv">$ </span>ifconfig cbr0 |grep PROMISC
UP BROADCAST RUNNING PROMISC MULTICAST  MTU:1460  Metric:1

</code></pre></div></div>

<ul>
  <li>Seek help if none of above works out.</li>
</ul>

<h2 id="seek-help">Seek help</h2>

<p>If you get this far, something very strange is happening.  Your <code class="highlighter-rouge">Service</code> is
running, has <code class="highlighter-rouge">Endpoints</code>, and your <code class="highlighter-rouge">Pods</code> are actually serving.  You have DNS
working, <code class="highlighter-rouge">iptables</code> rules installed, and <code class="highlighter-rouge">kube-proxy</code> does not seem to be
misbehaving.  And yet your <code class="highlighter-rouge">Service</code> is not working.  You should probably let
us know, so we can help investigate!</p>

<p>Contact us on
<a href="/docs/troubleshooting/#slack">Slack</a> or
<a href="https://groups.google.com/forum/#!forum/kubernetes-users">email</a> or
<a href="https://github.com/kubernetes/kubernetes">GitHub</a>.</p>

<h2 id="more-information">More information</h2>

<p>Visit <a href="/docs/troubleshooting/">troubleshooting document</a> for more information.</p>



        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/tasks/debug-application-cluster/debug-service.md?pixel" alt="Analytics" /></a></p>
        
	
        <script type="text/javascript">
            PDRTJS_settings_8345992 = {
                "id" : "8345992",
                "unique_id" : "/docs/tasks/debug-application-cluster/debug-service/",
                "title" : "Debug Services",
                "permalink" : "http://kubernetes.github.io/docs/tasks/debug-application-cluster/debug-service/"
            };
            (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
        </script>
        <a href="" onclick="window.open('https://github.com/kubernetes/kubernetes.github.io/issues/new?title=Issue%20with%20' +
        'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
	
        
          <a href="/editdocs#docs/tasks/debug-application-cluster/debug-service.md" class="button issue">Edit this Page</a>
        
    
    </div>
</section>

<footer>
    <main class="light-text">
        <nav>
            <a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a>
            <a href="/docs/home/">Documentation</a>
            <a href="http://blog.kubernetes.io/">Blog</a>
            <a href="/partners/">Partners</a>
            <a href="/community/">Community</a>
            <a href="/case-studies/">Case Studies</a>
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                <a href="/docs/setup/pick-right-solution/" class="button">Get Kubernetes</a>
                <a href="https://github.com/kubernetes/kubernetes" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2017 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2017 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">https://www.linuxfoundation.org/trademark-usage</a>
        </div>
    </main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>

<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
